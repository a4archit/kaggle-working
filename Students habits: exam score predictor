{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "a11c68fe",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-06-12T09:13:56.160972Z",
     "iopub.status.busy": "2025-06-12T09:13:56.160660Z",
     "iopub.status.idle": "2025-06-12T09:14:00.123128Z",
     "shell.execute_reply": "2025-06-12T09:14:00.121785Z"
    },
    "papermill": {
     "duration": 3.969485,
     "end_time": "2025-06-12T09:14:00.124449",
     "exception": false,
     "start_time": "2025-06-12T09:13:56.154964",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/student-habits-vs-academic-performance/student_habits_performance.csv\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "e5650082",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:00.133368Z",
     "iopub.status.busy": "2025-06-12T09:14:00.132939Z",
     "iopub.status.idle": "2025-06-12T09:14:00.861095Z",
     "shell.execute_reply": "2025-06-12T09:14:00.859932Z"
    },
    "papermill": {
     "duration": 0.734088,
     "end_time": "2025-06-12T09:14:00.862550",
     "exception": false,
     "start_time": "2025-06-12T09:14:00.128462",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import OrdinalEncoder, StandardScaler\n",
    "from sklearn.pipeline import Pipeline\n",
    "from sklearn.compose import ColumnTransformer\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.tree import DecisionTreeRegressor\n",
    "from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "f680a047",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:00.871371Z",
     "iopub.status.busy": "2025-06-12T09:14:00.871094Z",
     "iopub.status.idle": "2025-06-12T09:14:00.895681Z",
     "shell.execute_reply": "2025-06-12T09:14:00.894752Z"
    },
    "papermill": {
     "duration": 0.030551,
     "end_time": "2025-06-12T09:14:00.897083",
     "exception": false,
     "start_time": "2025-06-12T09:14:00.866532",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df = pd.read_csv(r\"/kaggle/input/student-habits-vs-academic-performance/student_habits_performance.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "b66ddefe",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:00.905668Z",
     "iopub.status.busy": "2025-06-12T09:14:00.905403Z",
     "iopub.status.idle": "2025-06-12T09:14:00.938963Z",
     "shell.execute_reply": "2025-06-12T09:14:00.937821Z"
    },
    "papermill": {
     "duration": 0.03947,
     "end_time": "2025-06-12T09:14:00.940465",
     "exception": false,
     "start_time": "2025-06-12T09:14:00.900995",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1000 entries, 0 to 999\n",
      "Data columns (total 16 columns):\n",
      " #   Column                         Non-Null Count  Dtype  \n",
      "---  ------                         --------------  -----  \n",
      " 0   student_id                     1000 non-null   object \n",
      " 1   age                            1000 non-null   int64  \n",
      " 2   gender                         1000 non-null   object \n",
      " 3   study_hours_per_day            1000 non-null   float64\n",
      " 4   social_media_hours             1000 non-null   float64\n",
      " 5   netflix_hours                  1000 non-null   float64\n",
      " 6   part_time_job                  1000 non-null   object \n",
      " 7   attendance_percentage          1000 non-null   float64\n",
      " 8   sleep_hours                    1000 non-null   float64\n",
      " 9   diet_quality                   1000 non-null   object \n",
      " 10  exercise_frequency             1000 non-null   int64  \n",
      " 11  parental_education_level       909 non-null    object \n",
      " 12  internet_quality               1000 non-null   object \n",
      " 13  mental_health_rating           1000 non-null   int64  \n",
      " 14  extracurricular_participation  1000 non-null   object \n",
      " 15  exam_score                     1000 non-null   float64\n",
      "dtypes: float64(6), int64(3), object(7)\n",
      "memory usage: 125.1+ KB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "bfa1a514",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:00.950266Z",
     "iopub.status.busy": "2025-06-12T09:14:00.949923Z",
     "iopub.status.idle": "2025-06-12T09:14:00.977358Z",
     "shell.execute_reply": "2025-06-12T09:14:00.976589Z"
    },
    "papermill": {
     "duration": 0.033587,
     "end_time": "2025-06-12T09:14:00.978735",
     "exception": false,
     "start_time": "2025-06-12T09:14:00.945148",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>student_id</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>study_hours_per_day</th>\n",
       "      <th>social_media_hours</th>\n",
       "      <th>netflix_hours</th>\n",
       "      <th>part_time_job</th>\n",
       "      <th>attendance_percentage</th>\n",
       "      <th>sleep_hours</th>\n",
       "      <th>diet_quality</th>\n",
       "      <th>exercise_frequency</th>\n",
       "      <th>parental_education_level</th>\n",
       "      <th>internet_quality</th>\n",
       "      <th>mental_health_rating</th>\n",
       "      <th>extracurricular_participation</th>\n",
       "      <th>exam_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>945</th>\n",
       "      <td>S1945</td>\n",
       "      <td>23</td>\n",
       "      <td>Male</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.9</td>\n",
       "      <td>2.1</td>\n",
       "      <td>Yes</td>\n",
       "      <td>98.9</td>\n",
       "      <td>6.4</td>\n",
       "      <td>Poor</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Average</td>\n",
       "      <td>7</td>\n",
       "      <td>No</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>240</th>\n",
       "      <td>S1240</td>\n",
       "      <td>18</td>\n",
       "      <td>Male</td>\n",
       "      <td>1.9</td>\n",
       "      <td>1.6</td>\n",
       "      <td>2.3</td>\n",
       "      <td>No</td>\n",
       "      <td>72.0</td>\n",
       "      <td>6.3</td>\n",
       "      <td>Fair</td>\n",
       "      <td>6</td>\n",
       "      <td>Master</td>\n",
       "      <td>Poor</td>\n",
       "      <td>3</td>\n",
       "      <td>No</td>\n",
       "      <td>51.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197</th>\n",
       "      <td>S1197</td>\n",
       "      <td>20</td>\n",
       "      <td>Female</td>\n",
       "      <td>4.1</td>\n",
       "      <td>2.7</td>\n",
       "      <td>0.0</td>\n",
       "      <td>No</td>\n",
       "      <td>89.5</td>\n",
       "      <td>6.5</td>\n",
       "      <td>Fair</td>\n",
       "      <td>0</td>\n",
       "      <td>Master</td>\n",
       "      <td>Average</td>\n",
       "      <td>9</td>\n",
       "      <td>Yes</td>\n",
       "      <td>87.1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    student_id  age  gender  study_hours_per_day  social_media_hours  \\\n",
       "945      S1945   23    Male                  6.0                 2.9   \n",
       "240      S1240   18    Male                  1.9                 1.6   \n",
       "197      S1197   20  Female                  4.1                 2.7   \n",
       "\n",
       "     netflix_hours part_time_job  attendance_percentage  sleep_hours  \\\n",
       "945            2.1           Yes                   98.9          6.4   \n",
       "240            2.3            No                   72.0          6.3   \n",
       "197            0.0            No                   89.5          6.5   \n",
       "\n",
       "    diet_quality  exercise_frequency parental_education_level  \\\n",
       "945         Poor                   0                      NaN   \n",
       "240         Fair                   6                   Master   \n",
       "197         Fair                   0                   Master   \n",
       "\n",
       "    internet_quality  mental_health_rating extracurricular_participation  \\\n",
       "945          Average                     7                            No   \n",
       "240             Poor                     3                            No   \n",
       "197          Average                     9                           Yes   \n",
       "\n",
       "     exam_score  \n",
       "945       100.0  \n",
       "240        51.2  \n",
       "197        87.1  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.sample(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "8c2069fd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:00.988221Z",
     "iopub.status.busy": "2025-06-12T09:14:00.987916Z",
     "iopub.status.idle": "2025-06-12T09:14:01.020444Z",
     "shell.execute_reply": "2025-06-12T09:14:01.019394Z"
    },
    "papermill": {
     "duration": 0.038943,
     "end_time": "2025-06-12T09:14:01.022255",
     "exception": false,
     "start_time": "2025-06-12T09:14:00.983312",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>study_hours_per_day</th>\n",
       "      <th>social_media_hours</th>\n",
       "      <th>netflix_hours</th>\n",
       "      <th>attendance_percentage</th>\n",
       "      <th>sleep_hours</th>\n",
       "      <th>exercise_frequency</th>\n",
       "      <th>mental_health_rating</th>\n",
       "      <th>exam_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>1000.0000</td>\n",
       "      <td>1000.00000</td>\n",
       "      <td>1000.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>20.4980</td>\n",
       "      <td>3.55010</td>\n",
       "      <td>2.505500</td>\n",
       "      <td>1.819700</td>\n",
       "      <td>84.131700</td>\n",
       "      <td>6.470100</td>\n",
       "      <td>3.042000</td>\n",
       "      <td>5.438000</td>\n",
       "      <td>69.601500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>2.3081</td>\n",
       "      <td>1.46889</td>\n",
       "      <td>1.172422</td>\n",
       "      <td>1.075118</td>\n",
       "      <td>9.399246</td>\n",
       "      <td>1.226377</td>\n",
       "      <td>2.025423</td>\n",
       "      <td>2.847501</td>\n",
       "      <td>16.888564</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>17.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>56.000000</td>\n",
       "      <td>3.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>18.400000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>18.7500</td>\n",
       "      <td>2.60000</td>\n",
       "      <td>1.700000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>78.000000</td>\n",
       "      <td>5.600000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>58.475000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>20.0000</td>\n",
       "      <td>3.50000</td>\n",
       "      <td>2.500000</td>\n",
       "      <td>1.800000</td>\n",
       "      <td>84.400000</td>\n",
       "      <td>6.500000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>70.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>23.0000</td>\n",
       "      <td>4.50000</td>\n",
       "      <td>3.300000</td>\n",
       "      <td>2.525000</td>\n",
       "      <td>91.025000</td>\n",
       "      <td>7.300000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>81.325000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>24.0000</td>\n",
       "      <td>8.30000</td>\n",
       "      <td>7.200000</td>\n",
       "      <td>5.400000</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>100.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             age  study_hours_per_day  social_media_hours  netflix_hours  \\\n",
       "count  1000.0000           1000.00000         1000.000000    1000.000000   \n",
       "mean     20.4980              3.55010            2.505500       1.819700   \n",
       "std       2.3081              1.46889            1.172422       1.075118   \n",
       "min      17.0000              0.00000            0.000000       0.000000   \n",
       "25%      18.7500              2.60000            1.700000       1.000000   \n",
       "50%      20.0000              3.50000            2.500000       1.800000   \n",
       "75%      23.0000              4.50000            3.300000       2.525000   \n",
       "max      24.0000              8.30000            7.200000       5.400000   \n",
       "\n",
       "       attendance_percentage  sleep_hours  exercise_frequency  \\\n",
       "count            1000.000000  1000.000000         1000.000000   \n",
       "mean               84.131700     6.470100            3.042000   \n",
       "std                 9.399246     1.226377            2.025423   \n",
       "min                56.000000     3.200000            0.000000   \n",
       "25%                78.000000     5.600000            1.000000   \n",
       "50%                84.400000     6.500000            3.000000   \n",
       "75%                91.025000     7.300000            5.000000   \n",
       "max               100.000000    10.000000            6.000000   \n",
       "\n",
       "       mental_health_rating   exam_score  \n",
       "count           1000.000000  1000.000000  \n",
       "mean               5.438000    69.601500  \n",
       "std                2.847501    16.888564  \n",
       "min                1.000000    18.400000  \n",
       "25%                3.000000    58.475000  \n",
       "50%                5.000000    70.500000  \n",
       "75%                8.000000    81.325000  \n",
       "max               10.000000   100.000000  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "f5c67d1e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.032549Z",
     "iopub.status.busy": "2025-06-12T09:14:01.032276Z",
     "iopub.status.idle": "2025-06-12T09:14:01.040553Z",
     "shell.execute_reply": "2025-06-12T09:14:01.039257Z"
    },
    "papermill": {
     "duration": 0.01578,
     "end_time": "2025-06-12T09:14:01.042390",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.026610",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "student_id                        0\n",
       "age                               0\n",
       "gender                            0\n",
       "study_hours_per_day               0\n",
       "social_media_hours                0\n",
       "netflix_hours                     0\n",
       "part_time_job                     0\n",
       "attendance_percentage             0\n",
       "sleep_hours                       0\n",
       "diet_quality                      0\n",
       "exercise_frequency                0\n",
       "parental_education_level         91\n",
       "internet_quality                  0\n",
       "mental_health_rating              0\n",
       "extracurricular_participation     0\n",
       "exam_score                        0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "b9527a91",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.052202Z",
     "iopub.status.busy": "2025-06-12T09:14:01.051829Z",
     "iopub.status.idle": "2025-06-12T09:14:01.061798Z",
     "shell.execute_reply": "2025-06-12T09:14:01.060817Z"
    },
    "papermill": {
     "duration": 0.016549,
     "end_time": "2025-06-12T09:14:01.063367",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.046818",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.duplicated().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "c6aca389",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.076656Z",
     "iopub.status.busy": "2025-06-12T09:14:01.076391Z",
     "iopub.status.idle": "2025-06-12T09:14:01.081248Z",
     "shell.execute_reply": "2025-06-12T09:14:01.080673Z"
    },
    "papermill": {
     "duration": 0.013574,
     "end_time": "2025-06-12T09:14:01.083170",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.069596",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Master', 'High School', 'Bachelor', nan], dtype=object)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.parental_education_level.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f4be8b55",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.098225Z",
     "iopub.status.busy": "2025-06-12T09:14:01.097787Z",
     "iopub.status.idle": "2025-06-12T09:14:01.103793Z",
     "shell.execute_reply": "2025-06-12T09:14:01.102861Z"
    },
    "papermill": {
     "duration": 0.014562,
     "end_time": "2025-06-12T09:14:01.105471",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.090909",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_13/943529539.py:1: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.\n",
      "The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.\n",
      "\n",
      "For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.\n",
      "\n",
      "\n",
      "  df.parental_education_level.fillna('not to say', inplace=True)\n"
     ]
    }
   ],
   "source": [
    "df.parental_education_level.fillna('not to say', inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "dad1ece0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.116437Z",
     "iopub.status.busy": "2025-06-12T09:14:01.116142Z",
     "iopub.status.idle": "2025-06-12T09:14:01.125043Z",
     "shell.execute_reply": "2025-06-12T09:14:01.123898Z"
    },
    "papermill": {
     "duration": 0.015748,
     "end_time": "2025-06-12T09:14:01.126722",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.110974",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "student_id                       1000\n",
       "gender                              3\n",
       "part_time_job                       2\n",
       "diet_quality                        3\n",
       "parental_education_level            4\n",
       "internet_quality                    3\n",
       "extracurricular_participation       2\n",
       "dtype: int64"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.select_dtypes(include=['object']).nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "efc1bc36",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.137434Z",
     "iopub.status.busy": "2025-06-12T09:14:01.136731Z",
     "iopub.status.idle": "2025-06-12T09:14:01.142404Z",
     "shell.execute_reply": "2025-06-12T09:14:01.141393Z"
    },
    "papermill": {
     "duration": 0.012955,
     "end_time": "2025-06-12T09:14:01.144494",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.131539",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df.drop(columns=['student_id', 'gender','extracurricular_participation'], inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "c3255cd9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.155219Z",
     "iopub.status.busy": "2025-06-12T09:14:01.154944Z",
     "iopub.status.idle": "2025-06-12T09:14:01.168559Z",
     "shell.execute_reply": "2025-06-12T09:14:01.167719Z"
    },
    "papermill": {
     "duration": 0.020999,
     "end_time": "2025-06-12T09:14:01.170559",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.149560",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>study_hours_per_day</th>\n",
       "      <th>social_media_hours</th>\n",
       "      <th>netflix_hours</th>\n",
       "      <th>part_time_job</th>\n",
       "      <th>attendance_percentage</th>\n",
       "      <th>sleep_hours</th>\n",
       "      <th>diet_quality</th>\n",
       "      <th>exercise_frequency</th>\n",
       "      <th>parental_education_level</th>\n",
       "      <th>internet_quality</th>\n",
       "      <th>mental_health_rating</th>\n",
       "      <th>exam_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>977</th>\n",
       "      <td>24</td>\n",
       "      <td>5.8</td>\n",
       "      <td>1.3</td>\n",
       "      <td>2.2</td>\n",
       "      <td>Yes</td>\n",
       "      <td>89.1</td>\n",
       "      <td>7.9</td>\n",
       "      <td>Good</td>\n",
       "      <td>5</td>\n",
       "      <td>High School</td>\n",
       "      <td>Average</td>\n",
       "      <td>1</td>\n",
       "      <td>99.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>152</th>\n",
       "      <td>17</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2.8</td>\n",
       "      <td>4.1</td>\n",
       "      <td>No</td>\n",
       "      <td>85.8</td>\n",
       "      <td>6.8</td>\n",
       "      <td>Good</td>\n",
       "      <td>4</td>\n",
       "      <td>High School</td>\n",
       "      <td>Good</td>\n",
       "      <td>7</td>\n",
       "      <td>90.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>484</th>\n",
       "      <td>21</td>\n",
       "      <td>1.9</td>\n",
       "      <td>1.2</td>\n",
       "      <td>0.9</td>\n",
       "      <td>No</td>\n",
       "      <td>85.3</td>\n",
       "      <td>5.1</td>\n",
       "      <td>Fair</td>\n",
       "      <td>2</td>\n",
       "      <td>Bachelor</td>\n",
       "      <td>Good</td>\n",
       "      <td>7</td>\n",
       "      <td>56.9</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     age  study_hours_per_day  social_media_hours  netflix_hours  \\\n",
       "977   24                  5.8                 1.3            2.2   \n",
       "152   17                  5.6                 2.8            4.1   \n",
       "484   21                  1.9                 1.2            0.9   \n",
       "\n",
       "    part_time_job  attendance_percentage  sleep_hours diet_quality  \\\n",
       "977           Yes                   89.1          7.9         Good   \n",
       "152            No                   85.8          6.8         Good   \n",
       "484            No                   85.3          5.1         Fair   \n",
       "\n",
       "     exercise_frequency parental_education_level internet_quality  \\\n",
       "977                   5              High School          Average   \n",
       "152                   4              High School             Good   \n",
       "484                   2                 Bachelor             Good   \n",
       "\n",
       "     mental_health_rating  exam_score  \n",
       "977                     1        99.0  \n",
       "152                     7        90.3  \n",
       "484                     7        56.9  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.sample(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "f29dbd52",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.181730Z",
     "iopub.status.busy": "2025-06-12T09:14:01.181442Z",
     "iopub.status.idle": "2025-06-12T09:14:01.190222Z",
     "shell.execute_reply": "2025-06-12T09:14:01.188816Z"
    },
    "papermill": {
     "duration": 0.016391,
     "end_time": "2025-06-12T09:14:01.191899",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.175508",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "for feature in df.select_dtypes(include=['object']):\n",
    "    df[feature] = df[feature].apply(lambda x: x.lower())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a480679a",
   "metadata": {
    "papermill": {
     "duration": 0.004063,
     "end_time": "2025-06-12T09:14:01.200787",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.196724",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Model working"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "13360ca4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.210710Z",
     "iopub.status.busy": "2025-06-12T09:14:01.210431Z",
     "iopub.status.idle": "2025-06-12T09:14:01.216171Z",
     "shell.execute_reply": "2025-06-12T09:14:01.215391Z"
    },
    "papermill": {
     "duration": 0.012536,
     "end_time": "2025-06-12T09:14:01.217587",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.205051",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "target = 'exam_score'\n",
    "\n",
    "X = df.drop(columns=[target])\n",
    "y = df[target]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "e80376bb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.228195Z",
     "iopub.status.busy": "2025-06-12T09:14:01.227790Z",
     "iopub.status.idle": "2025-06-12T09:14:01.240615Z",
     "shell.execute_reply": "2025-06-12T09:14:01.239454Z"
    },
    "papermill": {
     "duration": 0.019628,
     "end_time": "2025-06-12T09:14:01.242065",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.222437",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "categorical_cols = ['part_time_job', 'diet_quality','parental_education_level','internet_quality']\n",
    "\n",
    "preprocessing = ColumnTransformer(\n",
    "    transformers = [\n",
    "        ('encoding', OrdinalEncoder(dtype='int16'), categorical_cols)\n",
    "    ], remainder='passthrough'\n",
    ")\n",
    "\n",
    "encoded_array = preprocessing.fit_transform(X)\n",
    "encoded_df = pd.DataFrame(encoded_array, columns=list(preprocessing.get_feature_names_out()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "3ce54852",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.252368Z",
     "iopub.status.busy": "2025-06-12T09:14:01.252046Z",
     "iopub.status.idle": "2025-06-12T09:14:01.257156Z",
     "shell.execute_reply": "2025-06-12T09:14:01.256064Z"
    },
    "papermill": {
     "duration": 0.011673,
     "end_time": "2025-06-12T09:14:01.258492",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.246819",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "## removing prefix words ('remainder','encoded')\n",
    "encoded_df.rename(columns={col:col.split('__')[-1] for col in encoded_df}, inplace=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "9c99fc8e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.268637Z",
     "iopub.status.busy": "2025-06-12T09:14:01.268374Z",
     "iopub.status.idle": "2025-06-12T09:14:01.291055Z",
     "shell.execute_reply": "2025-06-12T09:14:01.289953Z"
    },
    "papermill": {
     "duration": 0.029457,
     "end_time": "2025-06-12T09:14:01.292532",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.263075",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "\n",
    "scaler = StandardScaler()\n",
    "X_scaled = scaler.fit_transform(encoded_df)\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, random_state=42, test_size=0.2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b931dbfb",
   "metadata": {
    "papermill": {
     "duration": 0.004068,
     "end_time": "2025-06-12T09:14:01.301216",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.297148",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "d6135e87",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.310563Z",
     "iopub.status.busy": "2025-06-12T09:14:01.310316Z",
     "iopub.status.idle": "2025-06-12T09:14:01.347858Z",
     "shell.execute_reply": "2025-06-12T09:14:01.346724Z"
    },
    "papermill": {
     "duration": 0.043988,
     "end_time": "2025-06-12T09:14:01.349303",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.305315",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MSE: 8.58\n",
      "MAE: 7.0\n",
      "R2 Score: 0.7131\n"
     ]
    }
   ],
   "source": [
    "dtree = DecisionTreeRegressor(ccp_alpha=0.001, criterion='absolute_error', max_depth=6, min_samples_split=5)\n",
    "\n",
    "dtree.fit(X_train, y_train)\n",
    "y_pred = dtree.predict(X_test)\n",
    "print(f\"MSE: {round(mean_squared_error(y_test, y_pred)**(1/2),2)}\")\n",
    "print(f\"MAE: {round(mean_absolute_error(y_test, y_pred),2)}\")\n",
    "print(f\"R2 Score: {round(r2_score(y_test, y_pred),4)}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "aedacce6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.359822Z",
     "iopub.status.busy": "2025-06-12T09:14:01.359533Z",
     "iopub.status.idle": "2025-06-12T09:14:01.364500Z",
     "shell.execute_reply": "2025-06-12T09:14:01.363630Z"
    },
    "papermill": {
     "duration": 0.012016,
     "end_time": "2025-06-12T09:14:01.366178",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.354162",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "model = Pipeline([\n",
    "    ('preprocessing', preprocessing),\n",
    "    ('prediction', dtree)\n",
    "])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "02717f4f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.376751Z",
     "iopub.status.busy": "2025-06-12T09:14:01.376459Z",
     "iopub.status.idle": "2025-06-12T09:14:01.394714Z",
     "shell.execute_reply": "2025-06-12T09:14:01.394063Z"
    },
    "papermill": {
     "duration": 0.024944,
     "end_time": "2025-06-12T09:14:01.395915",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.370971",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;preprocessing&#x27;,\n",
       "                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;encoding&#x27;,\n",
       "                                                  OrdinalEncoder(dtype=&#x27;int16&#x27;),\n",
       "                                                  [&#x27;part_time_job&#x27;,\n",
       "                                                   &#x27;diet_quality&#x27;,\n",
       "                                                   &#x27;parental_education_level&#x27;,\n",
       "                                                   &#x27;internet_quality&#x27;])])),\n",
       "                (&#x27;prediction&#x27;,\n",
       "                 DecisionTreeRegressor(ccp_alpha=0.001,\n",
       "                                       criterion=&#x27;absolute_error&#x27;, max_depth=6,\n",
       "                                       min_samples_split=5))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">Pipeline</label><div class=\"sk-toggleable__content\"><pre>Pipeline(steps=[(&#x27;preprocessing&#x27;,\n",
       "                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;encoding&#x27;,\n",
       "                                                  OrdinalEncoder(dtype=&#x27;int16&#x27;),\n",
       "                                                  [&#x27;part_time_job&#x27;,\n",
       "                                                   &#x27;diet_quality&#x27;,\n",
       "                                                   &#x27;parental_education_level&#x27;,\n",
       "                                                   &#x27;internet_quality&#x27;])])),\n",
       "                (&#x27;prediction&#x27;,\n",
       "                 DecisionTreeRegressor(ccp_alpha=0.001,\n",
       "                                       criterion=&#x27;absolute_error&#x27;, max_depth=6,\n",
       "                                       min_samples_split=5))])</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">preprocessing: ColumnTransformer</label><div class=\"sk-toggleable__content\"><pre>ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                  transformers=[(&#x27;encoding&#x27;, OrdinalEncoder(dtype=&#x27;int16&#x27;),\n",
       "                                 [&#x27;part_time_job&#x27;, &#x27;diet_quality&#x27;,\n",
       "                                  &#x27;parental_education_level&#x27;,\n",
       "                                  &#x27;internet_quality&#x27;])])</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">encoding</label><div class=\"sk-toggleable__content\"><pre>[&#x27;part_time_job&#x27;, &#x27;diet_quality&#x27;, &#x27;parental_education_level&#x27;, &#x27;internet_quality&#x27;]</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" ><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">OrdinalEncoder</label><div class=\"sk-toggleable__content\"><pre>OrdinalEncoder(dtype=&#x27;int16&#x27;)</pre></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" ><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">remainder</label><div class=\"sk-toggleable__content\"><pre>[&#x27;age&#x27;, &#x27;study_hours_per_day&#x27;, &#x27;social_media_hours&#x27;, &#x27;netflix_hours&#x27;, &#x27;attendance_percentage&#x27;, &#x27;sleep_hours&#x27;, &#x27;exercise_frequency&#x27;, &#x27;mental_health_rating&#x27;]</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-6\" type=\"checkbox\" ><label for=\"sk-estimator-id-6\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">passthrough</label><div class=\"sk-toggleable__content\"><pre>passthrough</pre></div></div></div></div></div></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-7\" type=\"checkbox\" ><label for=\"sk-estimator-id-7\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">DecisionTreeRegressor</label><div class=\"sk-toggleable__content\"><pre>DecisionTreeRegressor(ccp_alpha=0.001, criterion=&#x27;absolute_error&#x27;, max_depth=6,\n",
       "                      min_samples_split=5)</pre></div></div></div></div></div></div></div>"
      ],
      "text/plain": [
       "Pipeline(steps=[('preprocessing',\n",
       "                 ColumnTransformer(remainder='passthrough',\n",
       "                                   transformers=[('encoding',\n",
       "                                                  OrdinalEncoder(dtype='int16'),\n",
       "                                                  ['part_time_job',\n",
       "                                                   'diet_quality',\n",
       "                                                   'parental_education_level',\n",
       "                                                   'internet_quality'])])),\n",
       "                ('prediction',\n",
       "                 DecisionTreeRegressor(ccp_alpha=0.001,\n",
       "                                       criterion='absolute_error', max_depth=6,\n",
       "                                       min_samples_split=5))])"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "598b93c4",
   "metadata": {
    "papermill": {
     "duration": 0.004259,
     "end_time": "2025-06-12T09:14:01.405203",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.400944",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "ad48d2ab",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.415061Z",
     "iopub.status.busy": "2025-06-12T09:14:01.414736Z",
     "iopub.status.idle": "2025-06-12T09:14:01.418748Z",
     "shell.execute_reply": "2025-06-12T09:14:01.417935Z"
    },
    "papermill": {
     "duration": 0.010973,
     "end_time": "2025-06-12T09:14:01.420439",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.409466",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from typing import List, Dict, Literal, Annotated"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "bdc4cdc1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.431101Z",
     "iopub.status.busy": "2025-06-12T09:14:01.430508Z",
     "iopub.status.idle": "2025-06-12T09:14:01.447298Z",
     "shell.execute_reply": "2025-06-12T09:14:01.446340Z"
    },
    "papermill": {
     "duration": 0.023826,
     "end_time": "2025-06-12T09:14:01.449243",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.425417",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "79.9"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "class ExamScorePredictor:\n",
    "    \n",
    "    \"\"\" \n",
    "    \n",
    "    Introduction:\n",
    "    =============\n",
    "    \n",
    "        This is the class that contains the usefull functions for predicting the exam score \n",
    "        of an college student \n",
    "\n",
    "\n",
    "\n",
    "    Why this?\n",
    "    ========\n",
    "\n",
    "        I built this project to practice my skills, i.e., API development, Site Integration\n",
    "        and successful deplyoment to the server.\n",
    "        \n",
    "    \"\"\"\n",
    "\n",
    "\n",
    "    ## constructor\n",
    "    def __init__(self):\n",
    "        pass\n",
    "\n",
    "\n",
    "    ## function (01)\n",
    "    def predict(self,\n",
    "                age: int,\n",
    "                exercise_frequency: Annotated[int, '0 to 6'],\n",
    "                mental_health_rating: Annotated[int, '1 to 10'],\n",
    "                study_hours: float,\n",
    "                sleep_hours: float,\n",
    "                netflix_hours: float,\n",
    "                social_media_hours: float,\n",
    "                attendance_percentage: float,\n",
    "                is_part_time_job: Literal['yes','no'],\n",
    "                diet_quality: Literal['fair','good','poor'],\n",
    "                internet_quality: Literal['good','average','poor'],\n",
    "                parental_education_level: Literal['high school', 'bachelor','master','not to say']\n",
    "                \n",
    "               ) -> float | None :\n",
    "        \n",
    "        \"\"\" This function will predict the Exam Score of student \"\"\"\n",
    "\n",
    "        ## Note: we are not checking (validating) the parameters (because our focus on other tech regarding this project)\n",
    "\n",
    "        ## creating dictionary of input values\n",
    "        user_data: Dict[str, str] = {\n",
    "            'part_time_job': is_part_time_job,\n",
    "    \t\t'diet_quality': diet_quality,\n",
    "    \t\t'parental_education_level': parental_education_level,\n",
    "    \t\t'internet_quality': internet_quality,\n",
    "    \t\t'age': age,\n",
    "    \t\t'study_hours_per_day': study_hours,\n",
    "    \t\t'social_media_hours': social_media_hours,\n",
    "    \t\t'netflix_hours': netflix_hours,\n",
    "    \t\t'attendance_percentage': attendance_percentage,\n",
    "    \t\t'sleep_hours': sleep_hours,\n",
    "    \t\t'exercise_frequency': exercise_frequency,\n",
    "    \t\t'mental_health_rating': mental_health_rating,\n",
    "            'exam_score': 0\n",
    "        }\n",
    "        \n",
    "\n",
    "        xdf = pd.DataFrame(user_data, index=[1])\n",
    "\n",
    "        ## preprocessing (applying column transformations)\n",
    "        encoded_array = preprocessing.transform(xdf)\n",
    "\n",
    "        ## converting numpy array to pandas dataframe\n",
    "        encoded_df = pd.DataFrame(encoded_array, columns=list(preprocessing.get_feature_names_out()))\n",
    "\n",
    "        ## removing prefix from columns name\n",
    "        encoded_df.rename(columns={col:col.split('__')[-1] for col in encoded_df}, inplace=True)\n",
    "\n",
    "        ## scaling\n",
    "        scaled_data = scaler.transform(encoded_df)\n",
    "\n",
    "        ## predicting\n",
    "        prediction = dtree.predict(scaled_data)\n",
    "\n",
    "        return prediction[0]\n",
    "        \n",
    "\n",
    "        \n",
    "\n",
    "\n",
    "if __name__ == \"__main__\": # ------------------------------------------------------------------- Main execution\n",
    "    \n",
    "    esp = ExamScorePredictor()\n",
    "    predicted_exam_score = esp.predict(\n",
    "                age = 20,\n",
    "                exercise_frequency = 1,\n",
    "                mental_health_rating = 7,\n",
    "                study_hours = 4,\n",
    "                sleep_hours = 7,\n",
    "                netflix_hours = 1.2,\n",
    "                social_media_hours = 3.2,\n",
    "                attendance_percentage = 65,\n",
    "                is_part_time_job = 'yes',\n",
    "                diet_quality = 'fair',\n",
    "                internet_quality = 'good',\n",
    "                parental_education_level = 'bachelor'\n",
    "                )\n",
    "\n",
    "\n",
    "predicted_exam_score"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "692116b5",
   "metadata": {
    "papermill": {
     "duration": 0.004326,
     "end_time": "2025-06-12T09:14:01.459054",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.454728",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Saving files"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "626651ce",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-12T09:14:01.469499Z",
     "iopub.status.busy": "2025-06-12T09:14:01.469206Z",
     "iopub.status.idle": "2025-06-12T09:14:01.475907Z",
     "shell.execute_reply": "2025-06-12T09:14:01.474431Z"
    },
    "papermill": {
     "duration": 0.014142,
     "end_time": "2025-06-12T09:14:01.477651",
     "exception": false,
     "start_time": "2025-06-12T09:14:01.463509",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import pickle\n",
    "\n",
    "## saving preprocessor\n",
    "pickle.dump(preprocessing, open('preprocessor.pkl', 'wb'))\n",
    "\n",
    "## saving scaler\n",
    "pickle.dump(scaler, open('scaler.pkl', 'wb'))\n",
    "\n",
    "## saving model\n",
    "pickle.dump(dtree, open('model.pkl', 'wb'))"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 7122663,
     "sourceId": 11376681,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 31040,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.11"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 10.614472,
   "end_time": "2025-06-12T09:14:02.205214",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-06-12T09:13:51.590742",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
