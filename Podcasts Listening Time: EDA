{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e59d20c0",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:30.097212Z",
     "iopub.status.busy": "2025-04-02T23:49:30.096808Z",
     "iopub.status.idle": "2025-04-02T23:49:31.145638Z",
     "shell.execute_reply": "2025-04-02T23:49:31.144524Z"
    },
    "papermill": {
     "duration": 1.059193,
     "end_time": "2025-04-02T23:49:31.147412",
     "exception": false,
     "start_time": "2025-04-02T23:49:30.088219",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/playground-series-s5e4/sample_submission.csv\n",
      "/kaggle/input/playground-series-s5e4/train.csv\n",
      "/kaggle/input/playground-series-s5e4/test.csv\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "5a483996",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:31.163045Z",
     "iopub.status.busy": "2025-04-02T23:49:31.162507Z",
     "iopub.status.idle": "2025-04-02T23:49:33.121230Z",
     "shell.execute_reply": "2025-04-02T23:49:33.120216Z"
    },
    "papermill": {
     "duration": 1.968326,
     "end_time": "2025-04-02T23:49:33.123235",
     "exception": false,
     "start_time": "2025-04-02T23:49:31.154909",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import OrdinalEncoder, StandardScaler\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.neighbors import KNeighborsRegressor\n",
    "from sklearn.metrics import accuracy_score, mean_squared_error\n",
    "from sklearn.tree import DecisionTreeRegressor"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "9d4fc8fa",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:33.138391Z",
     "iopub.status.busy": "2025-04-02T23:49:33.137907Z",
     "iopub.status.idle": "2025-04-02T23:49:35.360236Z",
     "shell.execute_reply": "2025-04-02T23:49:35.359164Z"
    },
    "papermill": {
     "duration": 2.231866,
     "end_time": "2025-04-02T23:49:35.362158",
     "exception": false,
     "start_time": "2025-04-02T23:49:33.130292",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df = pd.read_csv('/kaggle/input/playground-series-s5e4/train.csv')\n",
    "res_df = df.copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "da79fcc8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:35.377059Z",
     "iopub.status.busy": "2025-04-02T23:49:35.376688Z",
     "iopub.status.idle": "2025-04-02T23:49:35.445158Z",
     "shell.execute_reply": "2025-04-02T23:49:35.443994Z"
    },
    "papermill": {
     "duration": 0.077778,
     "end_time": "2025-04-02T23:49:35.446872",
     "exception": false,
     "start_time": "2025-04-02T23:49:35.369094",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>Podcast_Name</th>\n",
       "      <th>Episode_Title</th>\n",
       "      <th>Episode_Length_minutes</th>\n",
       "      <th>Genre</th>\n",
       "      <th>Host_Popularity_percentage</th>\n",
       "      <th>Publication_Day</th>\n",
       "      <th>Publication_Time</th>\n",
       "      <th>Guest_Popularity_percentage</th>\n",
       "      <th>Number_of_Ads</th>\n",
       "      <th>Episode_Sentiment</th>\n",
       "      <th>Listening_Time_minutes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>460361</th>\n",
       "      <td>460361</td>\n",
       "      <td>Finance Focus</td>\n",
       "      <td>Episode 77</td>\n",
       "      <td>98.29</td>\n",
       "      <td>Business</td>\n",
       "      <td>84.46</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>Morning</td>\n",
       "      <td>95.92</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Neutral</td>\n",
       "      <td>72.35063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>571061</th>\n",
       "      <td>571061</td>\n",
       "      <td>Game Day</td>\n",
       "      <td>Episode 39</td>\n",
       "      <td>55.06</td>\n",
       "      <td>Sports</td>\n",
       "      <td>56.42</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Evening</td>\n",
       "      <td>34.21</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Negative</td>\n",
       "      <td>34.02437</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>304023</th>\n",
       "      <td>304023</td>\n",
       "      <td>Gadget Geek</td>\n",
       "      <td>Episode 52</td>\n",
       "      <td>84.78</td>\n",
       "      <td>Technology</td>\n",
       "      <td>86.63</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Night</td>\n",
       "      <td>88.66</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Positive</td>\n",
       "      <td>50.74076</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id   Podcast_Name Episode_Title  Episode_Length_minutes  \\\n",
       "460361  460361  Finance Focus    Episode 77                   98.29   \n",
       "571061  571061       Game Day    Episode 39                   55.06   \n",
       "304023  304023    Gadget Geek    Episode 52                   84.78   \n",
       "\n",
       "             Genre  Host_Popularity_percentage Publication_Day  \\\n",
       "460361    Business                       84.46         Tuesday   \n",
       "571061      Sports                       56.42          Friday   \n",
       "304023  Technology                       86.63          Friday   \n",
       "\n",
       "       Publication_Time  Guest_Popularity_percentage  Number_of_Ads  \\\n",
       "460361          Morning                        95.92            1.0   \n",
       "571061          Evening                        34.21            1.0   \n",
       "304023            Night                        88.66            2.0   \n",
       "\n",
       "       Episode_Sentiment  Listening_Time_minutes  \n",
       "460361           Neutral                72.35063  \n",
       "571061          Negative                34.02437  \n",
       "304023          Positive                50.74076  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.sample(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "a71c87ec",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:35.462311Z",
     "iopub.status.busy": "2025-04-02T23:49:35.461958Z",
     "iopub.status.idle": "2025-04-02T23:49:35.724528Z",
     "shell.execute_reply": "2025-04-02T23:49:35.723230Z"
    },
    "papermill": {
     "duration": 0.272209,
     "end_time": "2025-04-02T23:49:35.726283",
     "exception": false,
     "start_time": "2025-04-02T23:49:35.454074",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 750000 entries, 0 to 749999\n",
      "Data columns (total 12 columns):\n",
      " #   Column                       Non-Null Count   Dtype  \n",
      "---  ------                       --------------   -----  \n",
      " 0   id                           750000 non-null  int64  \n",
      " 1   Podcast_Name                 750000 non-null  object \n",
      " 2   Episode_Title                750000 non-null  object \n",
      " 3   Episode_Length_minutes       662907 non-null  float64\n",
      " 4   Genre                        750000 non-null  object \n",
      " 5   Host_Popularity_percentage   750000 non-null  float64\n",
      " 6   Publication_Day              750000 non-null  object \n",
      " 7   Publication_Time             750000 non-null  object \n",
      " 8   Guest_Popularity_percentage  603970 non-null  float64\n",
      " 9   Number_of_Ads                749999 non-null  float64\n",
      " 10  Episode_Sentiment            750000 non-null  object \n",
      " 11  Listening_Time_minutes       750000 non-null  float64\n",
      "dtypes: float64(5), int64(1), object(6)\n",
      "memory usage: 68.7+ MB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "94d93174",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:35.741646Z",
     "iopub.status.busy": "2025-04-02T23:49:35.741303Z",
     "iopub.status.idle": "2025-04-02T23:49:35.972811Z",
     "shell.execute_reply": "2025-04-02T23:49:35.971818Z"
    },
    "papermill": {
     "duration": 0.241102,
     "end_time": "2025-04-02T23:49:35.974594",
     "exception": false,
     "start_time": "2025-04-02T23:49:35.733492",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "id                                  0\n",
       "Podcast_Name                        0\n",
       "Episode_Title                       0\n",
       "Episode_Length_minutes          87093\n",
       "Genre                               0\n",
       "Host_Popularity_percentage          0\n",
       "Publication_Day                     0\n",
       "Publication_Time                    0\n",
       "Guest_Popularity_percentage    146030\n",
       "Number_of_Ads                       1\n",
       "Episode_Sentiment                   0\n",
       "Listening_Time_minutes              0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "b379cc4c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:35.990238Z",
     "iopub.status.busy": "2025-04-02T23:49:35.989876Z",
     "iopub.status.idle": "2025-04-02T23:49:35.995956Z",
     "shell.execute_reply": "2025-04-02T23:49:35.995004Z"
    },
    "papermill": {
     "duration": 0.015697,
     "end_time": "2025-04-02T23:49:35.997644",
     "exception": false,
     "start_time": "2025-04-02T23:49:35.981947",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.19470666666666667"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "146030/df.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "18e7b6ac",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:36.013762Z",
     "iopub.status.busy": "2025-04-02T23:49:36.013348Z",
     "iopub.status.idle": "2025-04-02T23:49:36.074816Z",
     "shell.execute_reply": "2025-04-02T23:49:36.073568Z"
    },
    "papermill": {
     "duration": 0.071531,
     "end_time": "2025-04-02T23:49:36.076770",
     "exception": false,
     "start_time": "2025-04-02T23:49:36.005239",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    662907.000000\n",
       "mean         64.504738\n",
       "std          32.969603\n",
       "min           0.000000\n",
       "25%          35.730000\n",
       "50%          63.840000\n",
       "75%          94.070000\n",
       "max         325.240000\n",
       "Name: Episode_Length_minutes, dtype: float64"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.Episode_Length_minutes.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "9104268d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:36.092935Z",
     "iopub.status.busy": "2025-04-02T23:49:36.092500Z",
     "iopub.status.idle": "2025-04-02T23:49:36.113146Z",
     "shell.execute_reply": "2025-04-02T23:49:36.112051Z"
    },
    "papermill": {
     "duration": 0.030925,
     "end_time": "2025-04-02T23:49:36.115203",
     "exception": false,
     "start_time": "2025-04-02T23:49:36.084278",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df.Episode_Length_minutes = df.Episode_Length_minutes.fillna(df.Episode_Length_minutes.mean())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "beda6be2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:36.131302Z",
     "iopub.status.busy": "2025-04-02T23:49:36.130898Z",
     "iopub.status.idle": "2025-04-02T23:49:36.155677Z",
     "shell.execute_reply": "2025-04-02T23:49:36.154580Z"
    },
    "papermill": {
     "duration": 0.035151,
     "end_time": "2025-04-02T23:49:36.157784",
     "exception": false,
     "start_time": "2025-04-02T23:49:36.122633",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df.Guest_Popularity_percentage = df.Guest_Popularity_percentage.fillna(df.Guest_Popularity_percentage.mean())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "2c413562",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:36.173742Z",
     "iopub.status.busy": "2025-04-02T23:49:36.173324Z",
     "iopub.status.idle": "2025-04-02T23:49:36.486851Z",
     "shell.execute_reply": "2025-04-02T23:49:36.485936Z"
    },
    "papermill": {
     "duration": 0.323515,
     "end_time": "2025-04-02T23:49:36.488721",
     "exception": false,
     "start_time": "2025-04-02T23:49:36.165206",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df.dropna(inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "5346b1a7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:36.504712Z",
     "iopub.status.busy": "2025-04-02T23:49:36.504343Z",
     "iopub.status.idle": "2025-04-02T23:49:36.732159Z",
     "shell.execute_reply": "2025-04-02T23:49:36.731088Z"
    },
    "papermill": {
     "duration": 0.2376,
     "end_time": "2025-04-02T23:49:36.733783",
     "exception": false,
     "start_time": "2025-04-02T23:49:36.496183",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "id                             0\n",
       "Podcast_Name                   0\n",
       "Episode_Title                  0\n",
       "Episode_Length_minutes         0\n",
       "Genre                          0\n",
       "Host_Popularity_percentage     0\n",
       "Publication_Day                0\n",
       "Publication_Time               0\n",
       "Guest_Popularity_percentage    0\n",
       "Number_of_Ads                  0\n",
       "Episode_Sentiment              0\n",
       "Listening_Time_minutes         0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "c83ea0ff",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:36.750224Z",
     "iopub.status.busy": "2025-04-02T23:49:36.749832Z",
     "iopub.status.idle": "2025-04-02T23:49:36.879899Z",
     "shell.execute_reply": "2025-04-02T23:49:36.878839Z"
    },
    "papermill": {
     "duration": 0.140465,
     "end_time": "2025-04-02T23:49:36.881898",
     "exception": false,
     "start_time": "2025-04-02T23:49:36.741433",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Episode_Length_minutes         0.866031\n",
       "Host_Popularity_percentage     0.050868\n",
       "Guest_Popularity_percentage   -0.014390\n",
       "Number_of_Ads                 -0.118337\n",
       "Listening_Time_minutes         1.000000\n",
       "Name: Listening_Time_minutes, dtype: float64"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.select_dtypes(include=['float']).corr()['Listening_Time_minutes']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "de9efff6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:36.898990Z",
     "iopub.status.busy": "2025-04-02T23:49:36.898577Z",
     "iopub.status.idle": "2025-04-02T23:49:37.392169Z",
     "shell.execute_reply": "2025-04-02T23:49:37.390886Z"
    },
    "papermill": {
     "duration": 0.504207,
     "end_time": "2025-04-02T23:49:37.394188",
     "exception": false,
     "start_time": "2025-04-02T23:49:36.889981",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df.Episode_Title = df.Episode_Title.apply(lambda x: int(x.split(' ')[1]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "f5fb9ba2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:37.410836Z",
     "iopub.status.busy": "2025-04-02T23:49:37.410395Z",
     "iopub.status.idle": "2025-04-02T23:49:37.472132Z",
     "shell.execute_reply": "2025-04-02T23:49:37.470960Z"
    },
    "papermill": {
     "duration": 0.072113,
     "end_time": "2025-04-02T23:49:37.474059",
     "exception": false,
     "start_time": "2025-04-02T23:49:37.401946",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Podcast_Name\n",
       "Tech Talks             22847\n",
       "Sports Weekly          20053\n",
       "Funny Folks            19635\n",
       "Tech Trends            19549\n",
       "Fitness First          19488\n",
       "Business Insights      19480\n",
       "Style Guide            19364\n",
       "Game Day               19271\n",
       "Melody Mix             18889\n",
       "Criminal Minds         17735\n",
       "Finance Focus          17628\n",
       "Detective Diaries      17452\n",
       "Crime Chronicles       17374\n",
       "Athlete's Arena        17327\n",
       "Fashion Forward        17280\n",
       "Tune Time              17254\n",
       "Business Briefs        17012\n",
       "Lifestyle Lounge       16661\n",
       "True Crime Stories     16373\n",
       "Sports Central         16191\n",
       "Digital Digest         16171\n",
       "Humor Hub              16144\n",
       "Mystery Matters        16002\n",
       "Comedy Corner          15927\n",
       "Joke Junction          15074\n",
       "Wellness Wave          15009\n",
       "Sport Spot             14778\n",
       "Gadget Geek            14770\n",
       "Home & Living          14686\n",
       "Laugh Line             14673\n",
       "Life Lessons           14464\n",
       "World Watch            14043\n",
       "Sound Waves            13928\n",
       "Global News            13649\n",
       "Mind & Body            13639\n",
       "Daily Digest           13391\n",
       "Money Matters          13380\n",
       "Current Affairs        13138\n",
       "Market Masters         13092\n",
       "Study Sessions         13053\n",
       "Innovators             12913\n",
       "Music Matters          12652\n",
       "Learning Lab           12291\n",
       "Educational Nuggets    12245\n",
       "Healthy Living         12198\n",
       "Brain Boost            11543\n",
       "Health Hour            11114\n",
       "News Roundup            9169\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.Podcast_Name.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "2d76f048",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:37.490940Z",
     "iopub.status.busy": "2025-04-02T23:49:37.490528Z",
     "iopub.status.idle": "2025-04-02T23:49:37.549870Z",
     "shell.execute_reply": "2025-04-02T23:49:37.548835Z"
    },
    "papermill": {
     "duration": 0.069804,
     "end_time": "2025-04-02T23:49:37.551728",
     "exception": false,
     "start_time": "2025-04-02T23:49:37.481924",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Publication_Time\n",
       "Night        196849\n",
       "Evening      195777\n",
       "Afternoon    179460\n",
       "Morning      177913\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.Publication_Time.value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f868f11b",
   "metadata": {
    "papermill": {
     "duration": 0.007591,
     "end_time": "2025-04-02T23:49:37.567450",
     "exception": false,
     "start_time": "2025-04-02T23:49:37.559859",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Data Preprocessing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "a6083463",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:37.584903Z",
     "iopub.status.busy": "2025-04-02T23:49:37.584493Z",
     "iopub.status.idle": "2025-04-02T23:49:37.641149Z",
     "shell.execute_reply": "2025-04-02T23:49:37.640041Z"
    },
    "papermill": {
     "duration": 0.068064,
     "end_time": "2025-04-02T23:49:37.643254",
     "exception": false,
     "start_time": "2025-04-02T23:49:37.575190",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "target = 'Listening_Time_minutes'\n",
    "X = df.drop(columns=[target])\n",
    "y = df[target]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6e3f5996",
   "metadata": {
    "papermill": {
     "duration": 0.007536,
     "end_time": "2025-04-02T23:49:37.658840",
     "exception": false,
     "start_time": "2025-04-02T23:49:37.651304",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Encoding columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "2b7cf783",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:37.675784Z",
     "iopub.status.busy": "2025-04-02T23:49:37.675382Z",
     "iopub.status.idle": "2025-04-02T23:49:38.412150Z",
     "shell.execute_reply": "2025-04-02T23:49:38.411144Z"
    },
    "papermill": {
     "duration": 0.747253,
     "end_time": "2025-04-02T23:49:38.414045",
     "exception": false,
     "start_time": "2025-04-02T23:49:37.666792",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "genre_encoder = OrdinalEncoder()\n",
    "Genre_encoded = genre_encoder.fit_transform(X[['Genre']])\n",
    "\n",
    "Publication_Day_encoder = OrdinalEncoder()\n",
    "Publication_Day_encoded = Publication_Day_encoder.fit_transform(X[['Publication_Day']])\n",
    "\n",
    "Publication_Time_encoder = OrdinalEncoder()\n",
    "Publication_Time_encoded = Publication_Time_encoder.fit_transform(X[['Publication_Time']])\n",
    "\n",
    "Episode_Sentiment_encoder = OrdinalEncoder()\n",
    "Episode_Sentiment_encoded = Episode_Sentiment_encoder.fit_transform(X[['Episode_Sentiment']])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "ec1ea87e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:38.431288Z",
     "iopub.status.busy": "2025-04-02T23:49:38.430924Z",
     "iopub.status.idle": "2025-04-02T23:49:38.447290Z",
     "shell.execute_reply": "2025-04-02T23:49:38.446158Z"
    },
    "papermill": {
     "duration": 0.027266,
     "end_time": "2025-04-02T23:49:38.449313",
     "exception": false,
     "start_time": "2025-04-02T23:49:38.422047",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "X.Genre = Genre_encoded\n",
    "X.Publication_Day = Publication_Day_encoded\n",
    "X.Publication_Time = Publication_Time_encoded\n",
    "X.Episode_Sentiment = Episode_Sentiment_encoded\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "77ee6619",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:38.466456Z",
     "iopub.status.busy": "2025-04-02T23:49:38.466076Z",
     "iopub.status.idle": "2025-04-02T23:49:38.509399Z",
     "shell.execute_reply": "2025-04-02T23:49:38.508179Z"
    },
    "papermill": {
     "duration": 0.054217,
     "end_time": "2025-04-02T23:49:38.511488",
     "exception": false,
     "start_time": "2025-04-02T23:49:38.457271",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "X.drop(columns=['id','Podcast_Name'], inplace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f18955ed",
   "metadata": {
    "papermill": {
     "duration": 0.007322,
     "end_time": "2025-04-02T23:49:38.526740",
     "exception": false,
     "start_time": "2025-04-02T23:49:38.519418",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Standardization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "3ba075a5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:38.543345Z",
     "iopub.status.busy": "2025-04-02T23:49:38.542944Z",
     "iopub.status.idle": "2025-04-02T23:49:38.726401Z",
     "shell.execute_reply": "2025-04-02T23:49:38.725283Z"
    },
    "papermill": {
     "duration": 0.194365,
     "end_time": "2025-04-02T23:49:38.728678",
     "exception": false,
     "start_time": "2025-04-02T23:49:38.534313",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "scaler = StandardScaler()\n",
    "X_scaled = scaler.fit_transform(X)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e2d73f10",
   "metadata": {
    "papermill": {
     "duration": 0.007389,
     "end_time": "2025-04-02T23:49:38.744167",
     "exception": false,
     "start_time": "2025-04-02T23:49:38.736778",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Train test split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "6c9616b8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:38.761090Z",
     "iopub.status.busy": "2025-04-02T23:49:38.760644Z",
     "iopub.status.idle": "2025-04-02T23:49:38.914697Z",
     "shell.execute_reply": "2025-04-02T23:49:38.913686Z"
    },
    "papermill": {
     "duration": 0.164533,
     "end_time": "2025-04-02T23:49:38.916559",
     "exception": false,
     "start_time": "2025-04-02T23:49:38.752026",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "1f9ecd12",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:49:38.933545Z",
     "iopub.status.busy": "2025-04-02T23:49:38.933186Z",
     "iopub.status.idle": "2025-04-02T23:51:38.821045Z",
     "shell.execute_reply": "2025-04-02T23:51:38.819941Z"
    },
    "papermill": {
     "duration": 119.90645,
     "end_time": "2025-04-02T23:51:38.830826",
     "exception": false,
     "start_time": "2025-04-02T23:49:38.924376",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Neighbors - 20: 13.75\n"
     ]
    }
   ],
   "source": [
    "# for i in range(3,26):\n",
    "i = 20\n",
    "knn = KNeighborsRegressor(n_neighbors=i)\n",
    "knn.fit(X_train, y_train)\n",
    "knn_pred = knn.predict(X_test)\n",
    "print(f\"Neighbors - {i}: {mean_squared_error(knn_pred, y_test, squared=False):.2f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "83ef1ed3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:51:38.848346Z",
     "iopub.status.busy": "2025-04-02T23:51:38.847996Z",
     "iopub.status.idle": "2025-04-02T23:51:42.852772Z",
     "shell.execute_reply": "2025-04-02T23:51:42.851603Z"
    },
    "papermill": {
     "duration": 4.015421,
     "end_time": "2025-04-02T23:51:42.854631",
     "exception": false,
     "start_time": "2025-04-02T23:51:38.839210",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "13.16122733845626"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tree = DecisionTreeRegressor(ccp_alpha=0.0001, max_depth=11)\n",
    "tree.fit(X_train, y_train)\n",
    "tree_pred = tree.predict(X_test)\n",
    "mean_squared_error(tree_pred, y_test, squared=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fc0a76d7",
   "metadata": {
    "papermill": {
     "duration": 0.007434,
     "end_time": "2025-04-02T23:51:42.870291",
     "exception": false,
     "start_time": "2025-04-02T23:51:42.862857",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Model Testing "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "5b26befe",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:51:42.887212Z",
     "iopub.status.busy": "2025-04-02T23:51:42.886816Z",
     "iopub.status.idle": "2025-04-02T23:55:35.112559Z",
     "shell.execute_reply": "2025-04-02T23:55:35.111282Z"
    },
    "papermill": {
     "duration": 232.23646,
     "end_time": "2025-04-02T23:55:35.114541",
     "exception": false,
     "start_time": "2025-04-02T23:51:42.878081",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "model = knn\n",
    "\n",
    "# data loading and preprocessing\n",
    "test = pd.read_csv('/kaggle/input/playground-series-s5e4/test.csv')\n",
    "test.Episode_Length_minutes = test.Episode_Length_minutes.fillna(test.Episode_Length_minutes.mean())\n",
    "test.Guest_Popularity_percentage = test.Guest_Popularity_percentage.fillna(test.Guest_Popularity_percentage.mean())\n",
    "test.dropna(inplace=True)\n",
    "test.Episode_Title = test.Episode_Title.apply(lambda x: int(x.split(' ')[1]))\n",
    "\n",
    "test.Genre = genre_encoder.fit_transform(test[['Genre']])\n",
    "test.Publication_Day = Publication_Day_encoder.fit_transform(test[['Publication_Day']])\n",
    "test.Publication_Time = Publication_Time_encoder.fit_transform(test[['Publication_Time']])\n",
    "test.Episode_Sentiment = Episode_Sentiment_encoder.fit_transform(test[['Episode_Sentiment']])\n",
    "\n",
    "reserved_ids = test[['id']]\n",
    "test.drop(columns=['id','Podcast_Name'], inplace=True)\n",
    "\n",
    "scaled = scaler.transform(test)\n",
    "\n",
    "prediction = model.predict(scaled)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "27bd49d1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:55:35.133002Z",
     "iopub.status.busy": "2025-04-02T23:55:35.132576Z",
     "iopub.status.idle": "2025-04-02T23:55:35.138711Z",
     "shell.execute_reply": "2025-04-02T23:55:35.137460Z"
    },
    "papermill": {
     "duration": 0.017704,
     "end_time": "2025-04-02T23:55:35.140832",
     "exception": false,
     "start_time": "2025-04-02T23:55:35.123128",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "podcasts_submit_1_data = pd.DataFrame({'id':reserved_ids['id'], 'Listening_Time_minutes':prediction})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "b24cebb4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-02T23:55:35.158371Z",
     "iopub.status.busy": "2025-04-02T23:55:35.158002Z",
     "iopub.status.idle": "2025-04-02T23:55:35.603041Z",
     "shell.execute_reply": "2025-04-02T23:55:35.602042Z"
    },
    "papermill": {
     "duration": 0.455785,
     "end_time": "2025-04-02T23:55:35.604863",
     "exception": false,
     "start_time": "2025-04-02T23:55:35.149078",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "podcasts_submit_1_data.to_csv('podcasts_submission_1.csv', index=False)"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 11351736,
     "sourceId": 91715,
     "sourceType": "competition"
    }
   ],
   "dockerImageVersionId": 30918,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 369.279184,
   "end_time": "2025-04-02T23:55:36.334191",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-04-02T23:49:27.055007",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
